# TMT-Integrator

**Goal**

The main purpose of TMT-Integrator is to extract and combine channel abundances from multiple TMT samples. It takes psm tables generated by Philosphor as input files and exports a general report in which columns are the sample names and rows are the abundances in a specified level. TMT-Integrator currently provides four levels in the output results, including gene, protein, peptide, and phosphor site levels.

**Methods/Workflow (Input/Output)**

There are five steps in TMT-Integrator, including (1) best PSM selection, (2) log transform and normalization, (3) PSM level normalization, (4) outlier removal, and (5) protein level normalization.

(1)	Best PSM selection

In order to have a good quantitation quality, we only include PSMs that pass the following criteria:

- With TMT modification
- Reference TMT channel intensity > 0
- Precursor ion purity >= 50%
- Summed (across all 10 channels) MS2 intensity >= 5% (2.5% for PHOSPHO)
- keep the best (highest summed MS2 intensity) PSM only among all PSMs identifying the same peptide ion in the same sample/fraction (i.e. same LC-MS/MS run)
- PSMs not mapping, as unique or razor peptides, to contaminant proteins (‘sp|…’ or ‘tr|…’ proteins in this dataset)
- PSMs with phosphorylation (only for phospho data)

(2)	Log transform and normalization

For each selected PSM, the 10 channel intensities are log2 transformed and then subtracted from the reference channel.   

(3)	PSM level normalization

For a PSM table, the selected PSMs are sorted and divided into 10 groups on the basis of their retention time. Then, we subtract the channel ratios from the median channel ratios of each PSM group.

(4)	Outlier removal

Interquartile range (IQR) algorithm: We compute the first quantile (Q1), the third quantile (Q3) and the interquartile range (IQR; Q3-Q1) in each PSM group and remove PSM with ratios outside of the boundaries of Q1-1.5xIQR and Q3+1.5xIQR.

(5)	Protein level normalization

There are two protein level normalization methods in TMT-Integrator. The first method is called MD which we calculate the median log2 ratio of the ith sample (m0) and center the ratios in a sample by subtracting m0 from each ratio. The second method is called GN which, in addition to MD, we calculate the median deviation and median absolute deviation of centered values (m1 and m2), and scale all values to derive the final measure using the equation: yij''=(yij’/m2)xm1+m0, where yij is the log2 ratio in the ith group of the jth sample.                                                                                                      

**Command**

  java -jar TMTIntegrator.jar TMTIntegrator.yaml PSM_Tables

  Example: java -jar -Xmx16g TMTIntegrator.jar TMTIntegrator.yaml /*_psm.tsv
